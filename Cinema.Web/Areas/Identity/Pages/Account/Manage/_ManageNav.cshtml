<ul class="nav nav-pills nav-stacked" id="nav-menu">
    <li><a href="/profile">Профиль</a></li>
    <li><a href="/change-password">Пароль</a></li>
    <li><a href="/personal-data">Личные данные</a></li>
    <li><a href="#" id="logout">Выйти</a></li>
</ul>

@section Scripts {
    <script>
        // Проверяем, авторизован ли пользователь
        document.addEventListener("DOMContentLoaded", function () {
            const token = localStorage.getItem('token');

            if (!token) {
                // Если токен отсутствует, перенаправляем на страницу входа
                alert("Вы не авторизованы. Пожалуйста, войдите.");
                window.location.href = '/login';
                return;
            }

            // Добавляем токен в заголовки для будущих запросов (например, на получение профиля)
            // Это демонстрация, если нужно сделать запрос для проверки токена
            fetch('/api/auth/validate', {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${token}`
                }
            }).then(response => {
                if (!response.ok) {
                    // Если токен недействителен, удаляем его и перенаправляем на страницу входа
                    localStorage.removeItem('token');
                    alert("Сессия истекла. Пожалуйста, войдите заново.");
                    window.location.href = '/login';
                }
            }).catch(error => {
                console.error("Ошибка при проверке токена:", error);
                alert("Ошибка проверки авторизации. Пожалуйста, войдите заново.");
                window.location.href = '/login';
            });
        });

        // Реализация выхода
        document.getElementById("logout").addEventListener("click", function (event) {
            event.preventDefault();
            localStorage.removeItem('token');
            alert("Вы вышли из системы.");
            window.location.href = '/login';
        });
    </script>
}